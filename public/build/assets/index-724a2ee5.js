import{C,f as d}from"./choices-b42e1b7a.js";import{s as h}from"./selectStudents-68a567db.js";import{s as m}from"./selectSeasons-873b5e3f.js";import{s as f}from"./selectCourses-8a0dc8fa.js";import{f as y}from"./fetch-b8ff0b47.js";import{s as p}from"./cookie-b23bf575.js";import"./_commonjsHelpers-725317a4.js";const b=({method:s})=>{const e="selectClassrooms";return{selectClassrooms:{el:null,url:null,urlSearch:{},data:[],staticQuery:{}},async initSelectClassrooms(){this[e].el=new C(`form.${s} [name="classroom_id"]`,{silent:!0,allowHTML:!1,searchResultLimit:10,renderSelectedChoices:"always",searchPlaceholderValue:"Cari kelas"}),this[e].url=this[e].el.passedElement.element.getAttribute("data-url"),this[e].urlSearch={},this[e].data=[],this.fetchClassrooms(),this[e].el.passedElement.element.addEventListener("search",async t=>{const a=t.detail.value;this[e].urlSearch={s_name:a},this.fetchClassrooms()},!1),this[e].el.passedElement.element.addEventListener("showDropdown",async()=>{this[e].el.input.element.value=this[e].urlSearch.s_name??""},!1)},fetchClassrooms:async function(){return new Promise((t,a)=>{this[e].fetchTimeout&&(clearTimeout(this[e].fetchTimeout),t([])),this[e].fetchTimeout=setTimeout(async()=>{let c=this[e].url;Object.keys(this[e].urlSearch).length>0&&(c+=`?${new URLSearchParams({...this[e].staticQuery,...this[e].urlSearch}).toString()}`),this[e].el.setChoices(await new Promise((n,E)=>{y(c).then(o=>{const{data:S}=o,u=S.map((i,T)=>({label:i.name,value:i.id,selected:i.id==this.body.classroom_id}));this[e].data=u,n(u)}).catch(o=>{console.log("ðŸš€ ~ file: selectClassrooms.js:90 ~ fetch ~ error:",o),n([])})}),"value","label",!0)},500)})},async fetchCurrentClassroom(){this[e].urlSearch={s_id:this.body.classroom_id},await this.fetchClassrooms()}}};window.editModal=w;function w(s){return{element:s,errors:null,body:{...r},editModalInit(){var e,t;this.initSelectStudents(),this.initSelectSeasons(),this.initSelectCourses(),this.initSelectClassrooms(),this.selectClassrooms.staticQuery={course_id:((t=(e=this.body)==null?void 0:e.course_id)==null?void 0:t.value)||""}},...d({method:"update"}),...h({method:"edit"}),...m({method:"edit"}),...f({method:"edit"}),...b({method:"edit"}),async editModalChangeHandler(e){e?(this.loading=!0,await this.fetchById(),await Promise.all([this.fetchCurrentStudent(),this.fetchCurrentSeason(),this.fetchCurrentCourse(),this.fetchCurrentClassroom()]),this.loading=!1):(this.body={...r},this.loading=!1)},updateSuccess(e){this.element.querySelector('button[aria-label="Close"]').click(),this.refreshTable()},async fetchById(){const e=await y(this.urlEdit),t={...e.user,...e};return this.body=t,t}}}const l='#table-filter-faculty-wrapper input[type="checkbox"]',g="filter-student-grade-faculty";document.querySelectorAll(l).forEach(function(s){s.addEventListener("change",e=>{let t=[];e.target.value==="on"?document.querySelector(l+"#table-filter-faculty-select-all").checked?document.querySelectorAll(l+"[value]").forEach(a=>{t.push(a.value)}):t=[]:document.querySelectorAll(l+":checked").forEach(a=>{t.push(a.value)}),p(g,t)})});const r={grade:0,student_id:"",course_id:"",classroom_id:"",season_id:"",user_id:""};window.pageDashboard=_;function _(s){return{element:s,loading:!1,data_id:null,urlEdit:null,urlUpdate:null,initPageDashboard(){},refreshTable(){const e=document.querySelector('button[aria-label="Refresh Table"]');e&&e.click()}}}window.createModal=v;function v(s){return{element:s,errors:null,body:{...r},createModalInit(){var e,t;this.initSelectStudents(),this.initSelectSeasons(),this.initSelectCourses(),this.initSelectClassrooms(),this.selectClassrooms.staticQuery={course_id:((t=(e=this.body)==null?void 0:e.course_id)==null?void 0:t.value)||""}},...d({method:"store"}),...h({method:"create"}),...m({method:"create"}),...f({method:"create"}),...b({method:"create"}),createModalChangeHandler(e){this.body={...r}},storeSuccess(e){this.element.querySelector('button[aria-label="Close"]').click(),this.refreshTable()}}}window.pageDashboard=k;function k(s){return{element:s,loading:!1,data_id:null,urlEdit:null,urlUpdate:null,initPageDashboard(){},refreshTable(){const e=document.querySelector('button[aria-label="Refresh Table"]');e&&e.click()}}}
