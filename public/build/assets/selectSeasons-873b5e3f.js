import{f as c}from"./fetch-b8ff0b47.js";import{C as o}from"./choices-b42e1b7a.js";const f=({method:r})=>{const e="selectSeasons";return{selectSeasons:{el:null,url:null,urlSearch:{},data:[]},async initSelectSeasons(){this[e].el=new o(`form.${r} [name="season_id"]`,{silent:!0,allowHTML:!1,searchResultLimit:10,renderSelectedChoices:"always",searchPlaceholderValue:"Cari semester"}),this[e].url=this[e].el.passedElement.element.getAttribute("data-url"),this[e].urlSearch={},this[e].data=[],this.fetchSeasons(),this[e].el.passedElement.element.addEventListener("search",async s=>{const n=s.detail.value;this[e].urlSearch={s_name:n},this.fetchSeasons()},!1),this[e].el.passedElement.element.addEventListener("showDropdown",async()=>{this[e].el.input.element.value=this[e].urlSearch.s_name??""},!1)},fetchSeasons:async function(){return new Promise((s,n)=>{this[e].fetchTimeout&&(clearTimeout(this[e].fetchTimeout),s([])),this[e].fetchTimeout=setTimeout(()=>{let i=this[e].url;Object.keys(this[e].urlSearch).length>0&&(i+=`?${new URLSearchParams(this[e].urlSearch).toString()}`),c(i).then(t=>{const{data:h}=t,a=h.map((l,u)=>({label:l.name,value:l.id,selected:l.id==this.body.season_id}));this[e].data=a,this[e].el.setChoices(a,"value","label",!0),s(a)}).catch(t=>{console.log("ðŸš€ ~ file: selectSeasons.js:90 ~ fetch ~ error:",t),s([])})},500)})},async fetchCurrentSeason(){this[e].urlSearch={s_id:this.body.season_id},await this.fetchSeasons()}}};export{f as s};
