import{f as u}from"./fetch-b8ff0b47.js";import{C as n}from"./choices-b42e1b7a.js";const f=({method:h})=>{const e="selectCourses";return{selectCourses:{el:null,url:null,urlSearch:{},data:[]},async initSelectCourses(){this[e].el=new n(`form.${h} [name="course_id"]`,{silent:!0,allowHTML:!1,searchResultLimit:10,renderSelectedChoices:"always",searchPlaceholderValue:"Cari mata kuliah"}),this[e].url=this[e].el.passedElement.element.getAttribute("data-url"),this[e].urlSearch={},this[e].data=[],this.fetchCourses(),this[e].el.passedElement.element.addEventListener("search",async t=>{const l=t.detail.value;this[e].urlSearch={s_name:l},this.fetchCourses()},!1),this[e].el.passedElement.element.addEventListener("showDropdown",async()=>{this[e].el.input.element.value=this[e].urlSearch.s_name??""},!1)},fetchCourses:async function(){return new Promise((t,l)=>{this[e].fetchTimeout&&(clearTimeout(this[e].fetchTimeout),t([])),this[e].fetchTimeout=setTimeout(()=>{let i=this[e].url;Object.keys(this[e].urlSearch).length>0&&(i+=`?${new URLSearchParams(this[e].urlSearch).toString()}`),u(i).then(s=>{const{data:c}=s,a=c.map((r,o)=>({label:r.name,value:r.id,selected:r.id==this.body.course_id}));this[e].data=a,this[e].el.setChoices(a,"value","label",!0),t(a)}).catch(s=>{console.log("ðŸš€ ~ file: selectCourses.js:90 ~ fetch ~ error:",s),t([])})},500)})},async fetchCurrentCourse(){this[e].urlSearch={s_id:this.body.course_id},await this.fetchCourses()}}};export{f as s};
